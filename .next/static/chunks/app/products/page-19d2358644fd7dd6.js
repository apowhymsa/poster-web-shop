(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[286],{6411:function(e,t,r){Promise.resolve().then(r.bind(r,4288))},4288:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return v}});var s=r(7437),a=r(7498),c=r(7759);let o=[{value:"1",label:"Популярные",disabled:!0},{value:"2",label:"Новые",disabled:!0},{value:"3",label:"Цена: Низкая - Высокая",disabled:!0},{value:"4",label:"Цена: Высокая - Низкая",disabled:!0}];var i=e=>{let{onChangeHandler:t,defaultValue:r}=e;return(0,s.jsx)(c.ZP,{options:o,className:"w-[245px]",onChange:t,styles:{control:(e,t)=>({...e,outline:t.isFocused?"1px solid #fb7185 !important":e.outline,border:t.isFocused?"1px solid #fb7185 !important":e.border}),option:(e,t)=>({...e,backgroundColor:t.isFocused?"#fda4af":t.isSelected?"#fb7185":e.backgroundColor,color:t.isFocused||t.isSelected?"white":"black"})},defaultValue:Number(r)>3?o[0]:o[Number(r)-1]})};r(8528);var l=r(8464);r(771);var n=r(6710),d=r(2265),u=e=>{let{onAfterChange:t,defaultValue:r}=e,[a,c]=(0,d.useState)(r||[0,1e4]);return(0,s.jsxs)("div",{className:"relative h-[44px]",children:[(0,s.jsx)(n.Z,{className:"horizontal-slider",thumbClassName:"example-thumb",trackClassName:"example-track",min:0,onAfterChange:t,max:1e4,value:a,onChange:e=>c(e),ariaLabel:["Минимальная цена","Максимальная цена"],ariaValuetext:e=>"Thumb value ".concat(e.valueNow),renderThumb:(e,t)=>(0,s.jsx)("div",{...e}),minDistance:10}),(0,s.jsx)("span",{className:"absolute left-[5px]",children:a[0]}),(0,s.jsx)("span",{className:"absolute right-[5px]",children:a[1]})]})},p=e=>{let{setVisible:t,isVisible:r,onChangeFilterPriceHandler:a,onChangeFilterCategoriesHandler:c,priceSliderDefaultValue:o,categoriesFilter:i}=e,n=(0,l.C)(e=>e.categoriesReducer).categories;return(0,s.jsx)("div",{className:r?"categories-filter-container categories-filter-container-active":"categories-filter-container",children:(0,s.jsxs)("div",{className:"categories-filter-content",children:[(0,s.jsxs)("div",{className:"categories",children:[(0,s.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"Категории"}),(0,s.jsx)("div",{className:"category-grid grid grid-cols-6 gap-5 gap-y-4",children:n.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center gap-x-2 flex-0",children:[(0,s.jsx)("input",{onChange:c,type:"checkbox",checked:!!i.find(t=>t===e.category_id),value:e.category_id,id:e.category_id,className:"h-4 w-4 rounded checked:text-rose-400 shadow-sm text-rose-400 focus:border-rose-300 focus:ring focus:ring-rose-200 focus:ring-offset-0 focus:ring-opacity-50 disabled:cursor-not-allowed disabled:text-gray-400"}),(0,s.jsx)("label",{htmlFor:e.category_id,className:"text-sm text-gray-700",children:e.category_name})]},e.category_id))})]}),(0,s.jsxs)("div",{className:"prices",children:[(0,s.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"Цена"}),(0,s.jsx)("div",{className:"slider-container w-[400px]",children:(0,s.jsx)(u,{onAfterChange:a,defaultValue:o})})]})]})})};r(9640);var m=r(9993),g=r(1769),f=e=>{let{isLoading:t}=e,r=(0,d.useMemo)(()=>[0,0,0,0,0,0,0,0],[]),a=(0,l.C)(e=>e.productsReducer).filteredProducts;return(0,s.jsx)("section",{className:"products-container",children:t?r.map(()=>(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(g.Z,{})})):a.length<=0?(0,s.jsx)("div",{children:"Нет товаров по применённым фильтрам"}):a.map(e=>(0,s.jsx)(m.Z,{product:e},e.product_id))})},h=r(4033),x=r(7465),b=r(3809),v=e=>{var t,r;let{productsData:c,categoriesData:o,isLoadingData:n}=e,[u,m]=(0,d.useState)(n),g=(0,h.useRouter)(),v=(0,h.usePathname)(),j=(0,h.useSearchParams)(),y=e=>{let t=new URLSearchParams(j);return t.get(e)},N=(0,l.T)(),[C,P]=(0,d.useState)(!1),[_,S]=(0,d.useState)((null===(t=y("category"))||void 0===t?void 0:t.split(","))||[]),[k,w]=(0,d.useState)(y("sort")||"1"),[F,I]=(0,d.useState)((null===(r=y("price"))||void 0===r?void 0:r.split("-"))||[0,1e4]);(0,d.useEffect)(()=>{N((0,x.RU)(c)),N((0,b.DG)(o)),m(!1)},[]),(0,d.useEffect)(()=>{N((0,x.ft)({categoriesFilter:_,sortFilter:k,priceFilter:F}))},[_,k,F]),(0,d.useEffect)(()=>{console.log("pathname changed")},[v]),(0,d.useEffect)(()=>{g.push("".concat(v,"?").concat(Z("category",_.join(","))),{scroll:!1})},[_]),(0,d.useEffect)(()=>{g.push("".concat(v,"?").concat(Z("sort",k)),{scroll:!1})},[k]),(0,d.useEffect)(()=>{g.push("".concat(v,"?").concat(Z("price",F.join("-"))),{scroll:!1})},[F]);let Z=(0,d.useCallback)((e,t)=>{let r=new URLSearchParams(j);return r.set(e,t),r.toString()},[j]);return(0,s.jsxs)("div",{className:"products-page",children:[(0,s.jsxs)("div",{className:"page-top",children:[(0,s.jsx)("h1",{className:"font-bold text-4xl text-white relative z-10",children:"Цветы"}),(0,s.jsx)("h3",{className:"mt-4 font-normal text-gray-50 relative z-10",children:"Самый быстрый способ проявить заботу"})]}),(0,s.jsxs)("aside",{className:"page-filters",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"filters-left flex gap-x-2 items-center",role:"button",onClick:()=>P(e=>!e),children:[(0,s.jsx)(a.Z,{className:"h-5 w-5 text-gray-400"}),(0,s.jsx)("span",{children:"Фильтр"})]}),(0,s.jsx)("span",{className:"filter-divider"}),(0,s.jsx)("span",{className:"text-gray-500 transition-colors hover:text-rose-400",role:"button",onClick:()=>{},children:"Очистить всё"})]}),(0,s.jsx)("div",{children:(0,s.jsx)(i,{onChangeHandler:e=>{console.log(null==e?void 0:e.value),w(e.value.toString())},defaultValue:Number(k)})})]}),(0,s.jsx)(p,{isVisible:C,setVisible:P,onChangeFilterCategoriesHandler:e=>{let t=e.target;if(t.checked)S(e=>[...e,t.value]);else{let e=_.filter(e=>e!==t.value);S(e)}console.log("CHECKED:",t.checked,t.value)},onChangeFilterPriceHandler:(e,t)=>{I(e)},priceSliderDefaultValue:F,categoriesFilter:_}),(0,s.jsx)(f,{isLoading:u})]})}},9993:function(e,t,r){"use strict";var s=r(7437),a=r(6691),c=r.n(a),o=r(1396),i=r.n(o);r(9640);var l=r(8464),n=r(2418),d=r(2265),u=r(8138),p=r(3030);t.Z=e=>{let{product:t,isButtonVisible:r=!0}=e,{info:a,error:o}=(0,p.Z)(),{isLoading:m,isLogged:g}=(0,d.useContext)(u.V),f=(0,l.T)();return(0,l.C)(e=>e.cartReducer).cart,(0,s.jsxs)("div",{className:"product-item",children:[(0,s.jsx)(i(),{className:"product-image",href:"/products/".concat(t.product_id),children:(0,s.jsx)(c(),{src:t.photo_origin?"https://poster-shop.joinposter.com".concat(t.photo_origin):"/flower_image.jpg",alt:"Product Image",width:0,height:0,sizes:"100vw",style:{width:"100%",height:"auto",objectFit:"cover",borderRadius:"8px",objectPosition:"center center",aspectRatio:"1 / 1"},placeholder:"blur",blurDataURL:"/flower_image.jpg",priority:!0})}),(0,s.jsxs)("div",{className:"product-description",children:[(0,s.jsx)(i(),{href:"/products/".concat(t.product_id),className:"product-name",title:t.product_name,children:t.product_name}),(0,s.jsxs)("span",{className:"product-price",children:["₴ ",t.price["1"].slice(0,-2)]})]}),r?(0,s.jsx)("button",{onClick:async()=>{g?(f((0,n.ZW)({product:t,quantity:1})),a("Товар успешно добавлен в корзину")):o("Чтобы добавить товар в корзину, войдите в учётную запись!")},className:"border border-rose-400 text-rose-400 px-4 py-2 rounded transition-colors hover:bg-rose-400 hover:text-white",children:"Добавить в корзину"}):null]})}},1769:function(e,t,r){"use strict";var s=r(7437),a=r(724);t.Z=()=>(0,s.jsxs)("div",{className:"product-item",children:[(0,s.jsx)("div",{className:"product-image",children:(0,s.jsx)(a.Z,{style:{width:"100%",height:"auto",objectFit:"cover",borderRadius:"8px",objectPosition:"center center",aspectRatio:"1 / 1"}})}),(0,s.jsxs)("div",{children:[(0,s.jsx)(a.Z,{}),(0,s.jsx)(a.Z,{})]}),(0,s.jsx)(a.Z,{})]})},8138:function(e,t,r){"use strict";r.d(t,{V:function(){return a}});var s=r(2265);let a=(0,s.createContext)({isLogged:!1,isLoading:!1})},3030:function(e,t,r){"use strict";var s=r(171);t.Z=()=>({error:(e,t)=>{s.toast.error(e,{position:"bottom-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored",...t})},info:(e,t)=>{s.toast.info(e,{position:"bottom-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored",...t})}})},2122:function(e,t,r){"use strict";r.d(t,{I:function(){return i},db:function(){return l}});var s=r(994),a=r(2464),c=r(9978);let o=(0,s.ZF)({apiKey:"AIzaSyByk7n5JzbWrLCffBJXGiXWnc8MZbe0JqU",authDomain:"poster-ecommerce-shop.firebaseapp.com",projectId:"poster-ecommerce-shop",storageBucket:"poster-ecommerce-shop.appspot.com",messagingSenderId:"14361184003",appId:"1:14361184003:web:d17bfd870e4195075bcb36",measurementId:"G-N1HBV39R4Y"}),i=(0,a.v0)(o),l=(0,c.ad)(o)},2418:function(e,t,r){"use strict";r.d(t,{$R:function(){return l},LL:function(){return d},RV:function(){return u},ZW:function(){return i},wz:function(){return n}});var s=r(8340),a=r(9978),c=r(2122);let o=(0,s.oM)({name:"cart",initialState:{cart:[]},reducers:{setCart:(e,t)=>{e.cart=t.payload,console.log("payload",t.payload)},setCartItem:(e,t)=>{let r=localStorage.getItem("authUserId"),s=e.cart.findIndex(e=>e.product.product_id===t.payload.product.product_id);-1!==s?e.cart[s].quantity+=t.payload.quantity:e.cart.push(t.payload),(0,a.pl)((0,a.JU)(c.db,"users",r.toString()),{cart:[...e.cart]},{merge:!0})},updateQuantity:(e,t)=>{let r=localStorage.getItem("authUserId"),s=e.cart.findIndex(e=>e.product.product_id===t.payload.product.product_id);e.cart[s].quantity=t.payload.quantity,(0,a.pl)((0,a.JU)(c.db,"users",r.toString()),{cart:[...e.cart]},{merge:!0})},deleteItem:(e,t)=>{let r=localStorage.getItem("authUserId");e.cart=e.cart.filter(e=>e.product.product_id!==t.payload.product.product_id),(0,a.pl)((0,a.JU)(c.db,"users",r.toString()),{cart:[...e.cart]},{merge:!0})},clearCart:e=>{let t=localStorage.getItem("authUserId");e.cart=[],(0,a.pl)((0,a.JU)(c.db,"users",t.toString()),{cart:[]},{merge:!0})}}}),{setCartItem:i,updateQuantity:l,deleteItem:n,clearCart:d,setCart:u}=o.actions;t.ZP=o.reducer},3809:function(e,t,r){"use strict";r.d(t,{DG:function(){return c}});var s=r(8340);let a=(0,s.oM)({name:"categories",initialState:{categories:[]},reducers:{setCategories:(e,t)=>{e.categories=t.payload}}}),{setCategories:c}=a.actions;t.ZP=a.reducer},8464:function(e,t,r){"use strict";r.d(t,{C:function(){return c},T:function(){return a}});var s=r(3198);let a=()=>(0,s.I0)(),c=s.v9},7465:function(e,t,r){"use strict";r.d(t,{RU:function(){return c},ft:function(){return o}});var s=r(8340);let a=(0,s.oM)({name:"products",initialState:{products:[],filteredProducts:[]},reducers:{setProducts:(e,t)=>{e.products=t.payload,e.filteredProducts=t.payload},filterProducts:(e,t)=>{switch(e.filteredProducts=[...e.products],t.payload.sortFilter){case"1":e.filteredProducts=[...e.products];break;case"2":e.filteredProducts=e.filteredProducts.reverse();break;case"3":e.filteredProducts=e.filteredProducts.sort((e,t)=>Number(e.price["1"].slice(0,-2))<Number(t.price["1"].slice(0,-2))?-1:Number(e.price["1"].slice(0,-2))>Number(t.price["1"].slice(0,-2))?1:0);break;case"4":e.filteredProducts=e.filteredProducts.sort((e,t)=>Number(e.price["1"].slice(0,-2))>Number(t.price["1"].slice(0,-2))?-1:Number(e.price["1"].slice(0,-2))<Number(t.price["1"].slice(0,-2))?1:0)}e.filteredProducts=e.filteredProducts.filter(e=>{let r=Number(e.price["1"].slice(0,-2));return r>=t.payload.priceFilter[0]&&r<=t.payload.priceFilter[1]}),""===t.payload.categoriesFilter[0]?t.payload.categoriesFilter.slice(1).length>0&&(e.filteredProducts=e.filteredProducts.filter(e=>t.payload.categoriesFilter.includes(e.menu_category_id))):t.payload.categoriesFilter.length>0&&(e.filteredProducts=e.filteredProducts.filter(e=>t.payload.categoriesFilter.includes(e.menu_category_id)))}}}),{setProducts:c,filterProducts:o}=a.actions;t.ZP=a.reducer},8528:function(){},9640:function(){},771:function(){}},function(e){e.O(0,[358,214,454,24,234,971,596,744],function(){return e(e.s=6411)}),_N_E=e.O()}]);